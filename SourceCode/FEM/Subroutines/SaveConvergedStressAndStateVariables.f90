!##################################################################################################
! This routine saves the converged stress and state variables by steps.
!--------------------------------------------------------------------------------------------------
! Date: 2014/02
!
! Authors:  Jan-Michel Farias
!           Thiago Andre Carniel
!           Paulo Bastos de Castro
!!------------------------------------------------------------------------------------------------
! Modifications:
! Date:         Author:
!##################################################################################################
subroutine SaveConvergedStressAndStateVariables( n , ElementList )

    !************************************************************************************
    ! DECLARATIONS OF VARIABLES
    !************************************************************************************
    ! Modules and implicit declarations
    ! -----------------------------------------------------------------------------------
    use ElementLibrary

    implicit none

    ! Input variables
    ! -----------------------------------------------------------------------------------
    integer :: n
    type(ClassElementsWrapper), dimension(n)  :: ElementList

    ! Internal variables
    ! -----------------------------------------------------------------------------------
    integer :: e , gp

    !************************************************************************************

    !************************************************************************************
    ! SAVING THE CONVERGED STATE
    !************************************************************************************

    do e=1,size(elementlist)

        do gp=1,size(elementlist(e)%el%GaussPoints)

            call ElementList(e)%el%GaussPoints(gp)%SaveConvergedState()

        enddo

    enddo

    !************************************************************************************

end subroutine
